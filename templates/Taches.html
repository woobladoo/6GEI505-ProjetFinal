<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ projet[4] }}</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/tache.css') }}"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="header">
      <h4>{{ projet[4] }}</h4>
      <div class="menu">
        <a href="{{ url_for('projet', id=projet[0]) }}" class="highlight-link"
          >Retour</a
        >
        <a href="{{ url_for('listeProjets') }}" class="highlight-link"
          >Projets</a
        >
        <a href="{{ url_for('profil') }}" class="highlight-link">Profil</a>
        <a href="#" class="user-icon">
          <img
            src="{{ url_for('static', filename='images/icon_utiliateur.jpg') }}"
            alt="User Icon"
            width="40"
            height="40"
        /></a>
      </div>
    </div>
    
    <div class="divider"></div>
    <div class="container-fluid d-flex justify-content-between">
      <div class="tache-titre" style="padding-right: 20px;">
        <div class="d-flex align-items-center">
          <h4 class="mb-0 me-2" style="font-size: 35px;">{{ tache[3] }}</h4> <!-- Task title -->
          <form method="POST" action="{{ url_for('delete_tache', projid=projet[0], tacheid=tache[0]) }}" class="mb-0">
            <button type="submit" class="btn btn-danger">Delete Task</button>
          </form>
        </div>
      </div>
    
      <div class="project-details gap-4">
        <div class="part3">
          <p>D√©but: {{ tache[4] }}</p>
          <p>Fin: {{ tache[5] }}</p>
        </div>
    
        <div class="column2">
          <button type="button" class="btn btn-primary">
            Ajouter employ√©
          </button>
          <button type="button" class="btn btn-light">
            Modifier statut
          </button>
        </div>
      </div>
    </div>
    
    
    
    

    <h4 class="description">Description</h4>   

    
      <div class="column">
        <p style="font-size: 12px">
          Cette t√¢che consiste √† faire des recherches sur les diff√©rentes
          fonctionnalit√©s qu'on utilise
        </p>
      </div>
      
      <div class="equipe">
        <h4>√âquipe sur la t√¢che</h4>
        {% if tache and tache['employes'] %}
          {% for employe in tache['employes'] %}
            <p>
              <a href="#" class="user-icon">
                <img src="{{ url_for('static', filename='images/icon_utiliateur.jpg') }}" alt="User Icon" width="40" height="40" />
              </a>
              {{ employe }}
            </p>
          {% endfor %}
        {% else %}
          <p>Aucun employ√© n'est assign√© √† cette t√¢che.</p>
        {% endif %}
      </div>
      
      
      

      </div>
        
        </p>
        <h4 class="equipe">Sous-t√¢ches</h4>

        <div class="task-status">
          <h4 class="A_faire">√Ä FAIRE</h4>
          <h4 class="en_cours">EN COURS</h4>
          <h4 class="complete">COMPL√âT√â</h4>
        </div>

        <div class="tasks-container row">
          <div
            class="column col-12 col-md-4"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <button class="add-button" onclick="showTaskForm()">+</button>
            <div id="task-form-container" style="display: none"></div>
    
            <!-- Affichage dynamique des taches -->
            {% for tache in taches %}
    
            <div
              class="task"
              id="task{{ tache[0] }}"
              draggable="true"
              ondragstart="drag(event)"
            >
              <!-- Nom t√¢che -->
              <a href="{{ url_for('tache', proj_id=projet[0], task_id=tache[0]) }}">
                <p>{{ tache[3] }}</p>
              </a>
              <p>D√©but: {{ tache[4] }}</p>
              <p>Fin: {{ tache[5] }}</p>
              <p>Statut: {{ tache[2] }}</p>
              <div class="icons">üë§üë§üë§</div>
            </div>
    
            {% endfor %}
          </div>
    
          <div
            class="column col-12 col-md-4"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <button class="add-button" onclick="showTaskForm()">+</button>
          </div>
    
          <div
            class="column col-12 col-md-4"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <button class="add-button" onclick="showTaskForm()">+</button>
          </div>
        </div>
        

        <script>
          // Fonction pour autoriser le d√©p√¥t
          function allowDrop(ev) {
            ev.preventDefault(); // Permet de d√©poser l'√©l√©ment
          }
    
          // Fonction pour commencer √† draguer l'√©l√©ment
          function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id); // Stocke l'id de l'√©l√©ment √† d√©placer
    
            if (ev.target.classList.contains("task")) {
              ev.dataTransfer.setData("text", ev.target.id);
            }
          }
    
          // Fonction pour g√©rer le d√©p√¥t de l'√©l√©ment
          function drop(ev) {
            ev.preventDefault(); // Emp√™che l'action par d√©faut
            var data = ev.dataTransfer.getData("text");
            var draggedElement = document.getElementById(data); // R√©cup√®re l'√©l√©ment dragu√©
            ev.target.appendChild(draggedElement); // Ajoute l'√©l√©ment dans la zone de d√©p√¥t
    
           // V√©rifiez que la cible est une zone valide (par exemple, une colonne)
            if (ev.target.classList.contains("column")) {
              ev.target.appendChild(draggedElement); // Ajoute l'√©l√©ment dans la zone de d√©p√¥t
            }
          }
        </script>
     
    
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
